<!-- views/pages/view.ejs -->

<!DOCTYPE html>
<html lang="en">

<head>
  <% include ../partials/header %>
</head>

<body class="container">

  <header>
    <% include ../partials/nav %>
  </header>
  <main>
    <div id="content">
      <form>
        <div class="form-group">
          <label for="name">姓名</label>
          <input type="text" class="form-control" id="name">
        </div>

        <div class="form-group">
            <label for="sex">性别</label>
          <div class="radio">
            <label for="sex_1">
              <input type="radio" name="sex" value="1" id="sex_1" checked> 男
            </label>

            <label for="sex_0">
              <input type="radio" name="sex" value="0" id="sex_0"> 女
            </label>
          </div>
        </div>

        <div class="form-group">
          <label for="name">成绩</label>
          <input type="text" class="form-control" id="degree">
        </div>

        <button type="button" onclick="add()" class="btn btn-default">提交</button>
      </form>
    </div>
  </main>

  <footer>
    <% include ../partials/footer %>
  </footer>

  <script>
    let model = {
      addData: (options) => {
        return $.ajax({
          url: '/api/insert',
          method: "POST",
          data: options
        })
      }
    }

    function add() {
      var data = {
        name: $('#name').val(),
        sex: $("input[name='sex']:checked").val(),
        degree: $('#degree').val()
      }

      for(var i in data){ 
        if(!data[i]){
          return false;
        }
      }

      model.addData(data).then(() => {
        window.location.href = '/';
      });
    }
  </script>
</body>

</html>